<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apicius</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <header>
            <div class="logo">
                <img src="assets/logo - v2.png" alt="Logo" class="logo-image">
                <span class="logo-text">Apicius</span>
            </div>
            <nav>
                <div class="header-controls">
                    <button id="settings-btn" class="icon-btn" title="Settings">⚙️</button>
                    <button id="add-recipe-btn" class="primary-btn">+ Add Recipe</button>
                </div>
            </nav>
        </header>

        <!-- Settings Modal -->
        <div id="settings-modal" class="modal hidden">
            <div class="modal-content settings-content">
                <span class="close-modal" id="close-settings">&times;</span>
                <h2>Settings</h2>
                
                <div class="setting-group">
                    <h3>Theme</h3>
                    <div class="theme-toggles">
                        <button class="theme-btn" data-theme="light">Light</button>
                        <button class="theme-btn" data-theme="dark">Dark</button>
                        <button class="theme-btn active" data-theme="system">System</button>
                    </div>
                </div>

                <div class="setting-group">
                    <h3>Data Storage</h3>
                    <p class="setting-desc">Choose where to save your recipes and images.</p>
                    <div class="folder-display">
                        <span id="current-data-path">Loading...</span>
                    </div>
                    <button id="change-folder-btn" class="secondary-btn">Change Folder</button>
                </div>
            </div>
        </div>

        <main>
            <div class="hero-section">
                <h1>Recipes</h1>
                <div class="search-container">
                    <div class="search-bar">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                        <input type="text" id="search-input" placeholder="Search recipes...">
                    </div>
                    <div class="filters">
                        <!-- Custom Multi-select for Tags -->
                        <div class="custom-dropdown" id="filter-tags-dropdown">
                            <button class="dropdown-btn" id="filter-tags-btn">Filter by Tags</button>
                            <div class="dropdown-content" id="filter-tags-list">
                                <!-- Checkboxes injected here -->
                            </div>
                        </div>

                        <!-- Custom Multi-select for Ingredients -->
                        <div class="custom-dropdown" id="filter-ingredients-dropdown">
                            <button class="dropdown-btn" id="filter-ingredients-btn">Filter by Ingredients</button>
                            <div class="dropdown-content" id="filter-ingredients-list">
                                <!-- Checkboxes injected here -->
                            </div>
                        </div>

                        <!-- Time Category Filter -->
                        <select id="filter-time-category">
                            <option value="">Any Time</option>
                            <option value="quick">Quick (< 30m)</option>
                            <option value="medium">Medium (30m - 1.5h)</option>
                            <option value="long">Long (1.5h - 24h)</option>
                            <option value="multiday">Multi-day (> 24h)</option>
                        </select>

                        <!-- Visual Rating Filter -->
                        <div class="rating-filter-container" id="rating-filter-container">
                            <div class="star-rating-input" id="filter-rating-stars">
                                <!-- Stars injected via JS -->
                            </div>
                            <span id="filter-rating-value" class="rating-value-display">Any</span>
                            <button id="clear-rating-filter" class="clear-btn hidden" title="Clear Filter">&times;</button>
                        </div>
                        
                        <button id="clear-all-filters-btn" class="btn-pill">Clear All</button>
                    </div>
                </div>
            </div>

            <div id="recipe-grid" class="recipe-grid">
                <!-- Recipes will be injected here -->
            </div>

            <!-- Recipe Detail View -->
            <div id="recipe-detail" class="recipe-detail hidden">
                <div class="detail-actions">
                    <button id="edit-btn" class="btn-secondary">Edit</button>
                    <button id="delete-btn" class="btn-danger">Delete</button>
                </div>
                
                <button id="back-btn" class="btn-pill">← Back to Recipes</button>
                
                <div class="detail-hero">
                    <div class="hero-image-wrapper">
                        <img id="detail-image" src="" alt="Recipe Image">
                        <div class="hero-overlay"></div>
                        <div class="hero-content">
                            <div class="hero-labels" id="detail-labels"></div>
                            <h1 id="detail-title"></h1>
                            <div class="detail-rating" id="detail-rating"></div>
                        </div>
                    </div>
                </div>

                <div class="detail-header">
                    <div class="detail-stats">
                        <div class="stat-item">
                            <span class="stat-label">Yield</span>
                            <span class="stat-value" id="detail-yield"></span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Active Time</span>
                            <span class="stat-value" id="detail-active-time"></span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Total Time</span>
                            <span class="stat-value" id="detail-total-time"></span>
                        </div>
                        <div class="stat-item" id="detail-source-container">
                            <span class="stat-label">Source</span>
                            <span id="detail-source-wrapper" class="stat-value"></span>
                        </div>
                    </div>
                    
                    <p id="detail-description" class="detail-description"></p>
                </div>

                <div class="detail-content">
                    <div class="detail-ingredients">
                        <h3>Ingredients</h3>
                        <div id="detail-ingredients-list"></div>
                    </div>
                    
                    <div class="detail-instructions">
                        <h3>Directions</h3>
                        <div id="detail-instructions-list"></div>
                    </div>
                </div>

                <div class="detail-footer">
                    <div class="detail-notes-section">
                        <h3>Recipe Notes</h3>
                        <p id="detail-notes"></p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Add Recipe Modal -->
    <div id="add-modal" class="modal hidden">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h2>Add New Recipe</h2>
                <div class="close-modal" id="close-add-modal">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </div>
            </div>
            <div class="modal-body">
                <form id="add-recipe-form">
                    <div class="form-group">
                        <label for="recipe-title">Title</label>
                        <input type="text" id="recipe-title" class="clean-input" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="recipe-description">Description</label>
                        <textarea id="recipe-description" class="clean-input" rows="2"></textarea>
                    </div>
    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="recipe-yield">Yield</label>
                            <input type="text" id="recipe-yield" class="clean-input">
                        </div>
                        <div class="form-group">
                            <label for="recipe-active-time">Active Time</label>
                            <input type="text" id="recipe-active-time" class="clean-input">
                        </div>
                        <div class="form-group">
                            <label for="recipe-total-time">Total Time</label>
                            <input type="text" id="recipe-total-time" class="clean-input">
                        </div>
                    </div>
    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="recipe-source">Source</label>
                            <input type="text" id="recipe-source-name" class="clean-input">
                        </div>
                        <div class="form-group">
                            <label for="recipe-source-url">Source URL</label>
                            <input type="url" id="recipe-source-url" class="clean-input">
                        </div>
                        <div class="form-group">
                            <label>Rating</label>
                            <div class="rating-input">
                                <span data-value="1">☆</span><span data-value="2">☆</span><span data-value="3">☆</span><span data-value="4">☆</span><span data-value="5">☆</span>
                            </div>
                            <input type="hidden" id="recipe-rating">
                        </div>
                    </div>
    
                    <!-- Dynamic Ingredients -->
                    <div class="form-group">
                        <label>Ingredients</label>
                        <div id="ingredients-builder" class="builder-container">
                            <!-- Sections will be added here -->
                        </div>
                        <button type="button" id="add-ingredient-section-btn" class="btn-secondary">+ Add Ingredient Section</button>
                    </div>
    
                    <!-- Dynamic Instructions -->
                    <div class="form-group">
                        <label>Instructions</label>
                        <div id="instructions-builder" class="builder-container">
                            <!-- Sections will be added here -->
                        </div>
                        <button type="button" id="add-instruction-section-btn" class="btn-secondary">+ Add Instruction Section</button>
                    </div>
    
                    <div class="form-group">
                        <label>Notes</label>
                    <div class="rich-text-container">
                        <div class="editor-toolbar">
                            <button type="button" class="editor-btn" data-cmd="bold" title="Bold"><b>B</b></button>
                            <button type="button" class="editor-btn" data-cmd="italic" title="Italic"><i>I</i></button>
                            <button type="button" class="editor-btn" data-cmd="insertUnorderedList" title="Bullet List">•</button>
                        </div>
                        <div id="recipe-notes-editor" class="clean-input rich-editor" contenteditable="true" placeholder="Add notes..."></div>
                    </div>
                    </div>
    
                    <div class="form-group">
                        <label for="recipe-labels">Labels (comma separated)</label>
                        <div class="autocomplete-wrapper">
                            <input type="text" id="recipe-labels" class="clean-input" placeholder="e.g. Breakfast, Vegan, Quick">
                            <div id="tag-autocomplete-dropdown" class="autocomplete-dropdown hidden"></div>
                        </div>
                    </div>
    
                    <!-- Recipe Reference Autocomplete Dropdown (Dynamic Positioning) -->
                    <div id="recipe-reference-dropdown" class="autocomplete-dropdown hidden"></div>
    
                    <div class="form-group">
                        <label for="recipe-image-file">Image</label>
                        <input type="file" id="recipe-image-file" accept="image/*">
                    </div>
    
                    <!-- Hidden fields for compatibility/defaults -->
                    <input type="hidden" id="recipe-meal" value="">
                    <input type="hidden" id="recipe-type" value="">
    
                    <div class="form-actions">
                        <button type="submit" id="save-recipe-btn" class="primary-btn">Save Recipe</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Delete Recipe?</h3>
            <p>Are you sure you want to delete this recipe? This action cannot be undone.</p>
            <div class="modal-actions">
                <button id="cancel-delete-btn" class="btn-secondary">Cancel</button>
                <button id="confirm-delete-btn" class="btn-danger">Delete</button>
            </div>
        </div>
    </div>

    <script type="module" src="renderer/main.js"></script>
</body>
</html>
